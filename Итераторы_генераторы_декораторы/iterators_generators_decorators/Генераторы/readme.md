# Генераторы

## Оглавление
1. Введение
2. Генераторы
3. Конвейеры генераторов
***

### Введение
В прошлом уроке мы реализовывали собственные итераторы путем создания классов, содержащих два магических метода ``__iter__()`` и ``__next__()`` для поддержания протокола итератора. Делать это было несложно, однако достаточно долго и не очень удобно.<br>
В Python создавать собственные итераторы можно намного проще с помощью генераторов, которые делятся на два типа:<br>
- функции генераторы
- выражения генераторы

В этом уроке речь пойдет о функциях генераторах.<br>
#### Функции генераторы
Функция генератор – это функция, которая возвращает итератор. Она выглядит как обычная функция, за исключением того,что использует выражение ``yield``, а не ``return``.<br>
Когда вызывается обычная функция, она получает личное пространство имен, в котором создаются ее локальные переменные.<br> 
Когда обычная функция достигает оператора return, локальные переменные уничтожаются и значение возвращается вызывающей стороне.<br> 
Последующий вызов той же функции создает новое локальное пространство имен и новый набор локальных переменных.<br>
Функция генератор, напротив сохраняет локальные переменные от вызова к вызову. Это своего рода возобновляемая функция.<br>
Рассмотрим пример функции генератора, которая порождает последовательность целых чисел от 00 (включительно) до ``n`` (не включительно).<br>
> Пример кода
```python   
def generate_ints(n):
for num in range(n):
yield num

generator1 = generate_ints(5) # создаем генератор, порождающий числа 0 1 2 3 4
print(type(generator1))
print(next(generator1))
print(next(generator1))
print(next(generator1))
print(next(generator1))
print(next(generator1))
generator2 = generate_ints(3) # создаем генератор, порождающий числа 0 1 2
for num in generator2:
print(num)
num1, num2 = generate_ints(2) # создаем генератор, порождающий числа 0 1
print(num1, num2)
```
![image](https://github.com/user-attachments/assets/346bc6e8-5512-4549-b382-700d4d44770e)

>Вывод
```python
<class 'generator'>
0
1
2
3
4
0
1
2
0 1
```
![image](https://github.com/user-attachments/assets/02e4bf12-3237-481d-aeb2-6fcd4d749c07)

По сути, функция ``generate_ints()`` просто возвращает генератор, порождающий последовательность нужных чисел.<br>
Генератор – это итератор, который порождает значения, переданные ``yield``. Когда выполнение доходит до конца функции,
объект генератор возбуждает исключение ``StopIteration`` в полном соответствии с протоколом итератора.<br>
Работа с генератором происходит по стандартному сценарию работы с итератором.<br> Мы можем:<br>
- вызывать функцию ``next()`` для получения очередного значения генератора
- итерироваться с помощью цикла ``for`` по генератору
- распаковывать генератор
- проверять принадлежность с помощью оператора ``in``
- и т.д.

Функция генератор возвращает объект специального типа ``<class 'generator'>``, который реализует протокол итератора,
то есть является самым настоящим итератором.<br>
Как несложно понять, мы можем достичь эффекта генераторов вручную, написав свой собственный класс, поддерживающий
протокол итератора.<br>
Класс ``GenerateInts`` полностью аналогичен указанной выше функции генератору:
```python
class GenerateInts:
    def __init__(self, n):  # конструктор принимает верхнюю границу диапазона
        self.n = n
        self.current = 0

    def __iter__(self):
        return self

    def __next__(self):
        if self.current == self.n:
            raise StopIteration
        else:
            self.current += 1
        return self.current - 1

iterator1 = GenerateInts(5)  # создаем итератор, содержащий числа 0 1 2 3 4
print(type(iterator1))
print(next(iterator1))
print(next(iterator1))
print(next(iterator1))
print(next(iterator1))
print(next(iterator1))
iterator2 = GenerateInts(3)  # создаем итератор, содержащий числа 0 1 2
for num in iterator2:
    print(num)
num1, num2 = GenerateInts(2)  # создаем итератор, содержащий числа 0 1
print(num1, num2)
```
![image](https://github.com/user-attachments/assets/d94d6288-04ab-4af5-b205-b7f77ac47cb7)
>Вывод
```python
<class '__main__.GenerateInts'>
0
1
2
3
4
0
1
2
0 1
```
![image](https://github.com/user-attachments/assets/b51a1005-2133-44dc-b220-ce5056c2bffe)

















